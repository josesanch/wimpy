<?
class html_base_form extends html_object {

	private $model, $data = '';

	public function __construct($model, $colums = '', $sql = '') {
		$this->model = $model;
	}


	public function add($str) {
		$this->data .= $str;
	}

	public function toHtml() {

		return $this->head().$this->getParsedData().$this->foot();
	}

	private function head() {

		$str = init_extjs()."<form name='".get_class($this->model)."' action='/admin/".get_class($this->model)."/save/' method='post'>";
		foreach($this->model->getPrimaryKeys() as $item) {
			$str .= "<input type='hidden' name='$item' value='".$this->model->$item."'>";
		}
		return $str;

	}

	private function foot() {
		return "</form>";
	}

	public function setButtons($buttons) {


	}


	private function getParsedData() {
		$data = $this->data;
		$template = new html_template();
		$template->loadData($data);
		$template->assign("model", $this->model);
		$str =  $template->toHtml();
		$str .= "<script>Ext.QuickTips.init();";

		foreach($template->getFormItems() as $item) {
			$str .= html_extjs_field::toHtml($this->model, $item, $item);
		}
		$str .= "</script>";
		return $str;

	}
}
?>
